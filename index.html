<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Relatório de Inspeção</title>

  <!-- Estes metas são atualizados pelo JS (applyTheme) -->
  <meta name="color-scheme" content="light" />
  <meta name="theme-color" content="#0E3554" />

  <!-- CSS principal -->
  <link rel="stylesheet" href="style.css" />

 

  <!-- jsPDF (geração de PDF “texto”) -->
  <script defer src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>

  <!-- Script principal -->
  <script src="script.js" defer></script>
</head>
<body>
  <!-- Sprite de ícones (carregado uma única vez) -->
  <svg xmlns="http://www.w3.org/2000/svg" style="position:absolute;width:0;height:0;overflow:hidden" aria-hidden="true" focusable="false">
    <symbol id="i-plus" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round">
      <path d="M12 5v14M5 12h14"/>
    </symbol>
    <symbol id="i-save" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linejoin="round" stroke-linecap="round">
      <path d="M5 4h10l4 4v12a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2z"/>
      <path d="M9 4v6h6"/>
    </symbol>
    <symbol id="i-file-pdf" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linejoin="round" stroke-linecap="round">
      <path d="M14 3H6a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"/>
      <path d="M14 3v6h6"/>
    </symbol>
    <symbol id="i-printer" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linejoin="round" stroke-linecap="round">
      <path d="M6 9V4h12v5"/>
      <rect x="6" y="13" width="12" height="7" rx="2"/>
      <path d="M6 13h12"/>
    </symbol>
    <symbol id="i-search" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round">
      <circle cx="11" cy="11" r="7"/><path d="M21 21l-3.6-3.6"/>
    </symbol>
    <symbol id="i-image" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linejoin="round" stroke-linecap="round">
      <rect x="3" y="5" width="18" height="14" rx="2"/>
      <path d="M8 13l3-3 5 6"/>
      <circle cx="8.5" cy="9.5" r="1.5"/>
    </symbol>
    <symbol id="i-paperclip" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round">
      <path d="M21.44 11.05l-8.49 8.49a6 6 0 01-8.49-8.49l8.49-8.49a4 4 0 015.66 5.66l-8.49 8.49a2 2 0 01-2.83-2.83l7.07-7.07"/>
    </symbol>
    <symbol id="i-reset" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linejoin="round" stroke-linecap="round">
      <path d="M3 12a9 9 0 1 0 3-6.74"/>
      <path d="M3 4v6h6"/>
    </symbol>
  </svg>

  <a class="sr-only sr-only-focusable" href="#conteudo">Pular para o conteúdo</a>

  <header class="topbar" role="banner">
    <div class="container topbar__inner">
      <div class="brand" aria-label="Shiva Conexões">
        <img src="shiva.png" alt="Shiva Conexões" />
        <div class="brand-text">
          <span class="brand-title">Relatório de Inspeção</span>
          <span class="brand-sub">Laudo Interno</span>
        </div>
      </div>

      <div class="topbar__right">
        <nav class="actions" role="group" aria-label="Ações do relatório">
          <div class="btn-group">
            <button id="btnNovo" class="btn btn--secondary" type="button"
                    title="Iniciar um novo relatório (limpar campos)">
              <svg class="icon" aria-hidden="true"><use href="#i-reset"/></svg>
              Novo
            </button>

            <button id="btnSalvar" class="btn btn--primary" type="button" title="Salvar no navegador">
              <svg class="icon" aria-hidden="true"><use href="#i-save"/></svg>
              Salvar
            </button>
          </div>

          <div class="btn-group">
            <button id="btnPDF" class="btn btn--secondary" type="button" title="Gerar PDF (texto)">
              <svg class="icon" aria-hidden="true"><use href="#i-file-pdf"/></svg>
              PDF
            </button>
            <button id="btnImprimir" class="btn btn--secondary" type="button" title="Imprimir página">
              <svg class="icon" aria-hidden="true"><use href="#i-printer"/></svg>
              Imprimir
            </button>
          </div>
        </nav>
      </div>
    </div>
  </header>

  <main class="layout" id="app" role="main">
    <div class="container">
      <div id="ariaLive" class="sr-only" aria-live="polite" aria-atomic="true"></div>

      <aside class="lista-relatorios" aria-label="Relatórios salvos">
        <div class="aside-head">
          <h2>Relatórios</h2>
          <div class="search-group">
            <label for="filtroLista" class="sr-only">Buscar em relatórios salvos</label>
            <input id="filtroLista" placeholder="Buscar..." type="search" autocomplete="off" />
            <button type="button" id="btnBuscarRelatorio" class="btn btn--secondary" title="Buscar relatório">
              <svg class="icon" aria-hidden="true"><use href="#i-search"/></svg>
              Buscar
            </button>
          </div>
          <div class="aside-buttons"></div>
        </div>
        <ul id="listaRelatorios" aria-live="polite"></ul>
      </aside>

      <section class="conteudo" id="conteudo" tabindex="-1">
        <form id="formRelatorio" novalidate>
          <!-- Identificação do Relatório -->
          <fieldset>
            <legend>Identificação do Relatório</legend>
            <div class="grid">
              <label for="numeroRelatorio">Nº do Relatório</label>
              <input required id="numeroRelatorio" name="numeroRelatorio" autocomplete="off" inputmode="numeric" />

              <label for="fornecedorFabricante">Fornecedor/Fabricante</label>
              <input id="fornecedorFabricante" name="fornecedorFabricante" autocomplete="organization" />

              <label for="interessado">Interessado</label>
              <input id="interessado" name="interessado" autocomplete="name" />

              <label for="ordemProducao">Empenho</label>
              <input id="ordemProducao" name="ordemProducao" autocomplete="off" inputmode="numeric" />

              <label for="quantidade">Quantidade</label>
              <input id="quantidade" name="quantidade" type="number" min="1" value="1" />

              <div class="periodo-field">
                <div class="p-left">
                  <label for="dataInicio">Período de Inspeção</label>
                </div>
                <div class="p-right">
                  <div class="periodo-inspecao">
                    <input required id="dataInicio" name="dataInicio" type="datetime-local" />
                    <span class="ate">até</span>
                    <input required id="dataFim" name="dataFim" type="datetime-local"  />
                  </div>
                </div>

                <div class="p-left">
                  <label for="totalHoras">Total de Horas</label>
                </div>
                <div class="p-right">
                  <input id="totalHoras" name="totalHoras" type="text" placeholder="00:00" />
                </div>

                <div class="p-left">
                  <label for="laboratorio">Laboratório</label>
                </div>
                <div class="p-right">
                  <input required id="laboratorio" name="laboratorio" autocomplete="organization" />
                </div>
              </div>

              <label for="normasReferencia" class="full">Norma Técnica</label>
              <select id="normasReferencia" name="normasReferencia">
                <option value="">Selecione...</option>
                <option value="ABNT NBR 5648:2018">ABNT NBR 5648:2018</option>
                <option value="ABNT NBR 8219">ABNT NBR 8219</option>
                <option value="ABNT NBR NM 82">ABNT NBR NM 82</option>
                <option value="EN 62321-3-1:2014">EN 62321-3-1:2014</option>
                <option value="ABNT NBR NM 84">ABNT NBR NM 84</option>
                <option value="ABNT NBR 8218">ABNT NBR 8218</option>
                <option value="ABNT NBR 14264">ABNT NBR 14264</option>
                <option value="ABNT NBR 7371">ABNT NBR 7371</option>
                <option value="ISO 13259:2020 Condição B">ISO 13259:2020 — Condição B: com deflexão diametral</option>
                <option value="ISO 13259:2020 Condição C">ISO 13259:2020 — Condição C: com deflexão angular</option>
                <option value="ISO 3260:2010 Metodo A">ISO 3260:2010 — Método A: água quente e fria</option>
                <option value="ISO 3260:2010 Metodo B">ISO 3260:2010 — Método B: água quente e fria</option>
                <option value="NBR 9822">NBR 9822</option>
                <option value="NBR 7231">NBR 7231</option>
                <option value="NBR 6483">NBR 6483</option>
                <option value="NBR 21138">NBR 21138</option>
                <option value="5647">5647</option>
                <option value="5648">5648</option>
                <option value="5688">5688</option>
                <option value="7362">7362</option>
                <option value="7665">7665</option>
              </select>
            </div>
          </fieldset>

          <!-- Identificação das Amostras -->
          <fieldset>
            <legend>Identificação da(s) Amostra(s)</legend>
            <div id="amostras"></div>
            <button type="button" class="btn btn--secondary" id="btnAddAmostra">
              <svg class="icon" aria-hidden="true"><use href="#i-plus"/></svg>
              Adicionar amostra
            </button>
          </fieldset>

          <!-- Métodos e Materiais -->
          <fieldset class="no-print">
            <legend>Métodos e Materiais Empregados</legend>
            <p class="hint">
              Cadastro interno (não sai no relatório). Preencha e clique em <strong>Incluir</strong>.
              Use <strong>Limpar</strong> para reiniciar os campos.
            </p>

            <div class="grid">
              <label for="ensaioRealizado">Resultado de Ensaio</label>
              <select id="ensaioRealizado">
                <option value="">Selecione...</option>
                <option value="phi">Pressão Hidrostática (PHI)</option>
                <option value="junta">Pressão Hidrostática (Junta Elástica)</option>
                <option value="vácuo">Vácuo</option>
                <option value="dimensional">Dimensional</option>
                <option value="marcacoes">Marcações</option>
                <option value="achatamento">Achatamento</option>
                <option value="calor">Comportamento ao calor</option>
                <option value="impacto">Resistência ao impacto</option>
                <option value="estanquiedade_junta">Estanquiedade da junta com anel de vedação elastomérico</option>
                <option value="resistencia_flexibilidade">Resistência mecânica ou flexibilidade</option>
              </select>

              <label for="amostrasSelect">Amostras</label>
              <select id="amostrasSelect">
                <option value="">Selecione...</option>
                <option value="01">01</option><option value="02">02</option><option value="03">03</option>
                <option value="04">04</option><option value="05">05</option><option value="06">06</option>
                <option value="07">07</option><option value="08">08</option><option value="09">09</option>
                <option value="10">10</option><option value="11">11</option><option value="12">12</option>
                <option value="13">13</option><option value="14">14</option><option value="15">15</option>
                <option value="20">20</option><option value="32">32</option><option value="50">50</option>
                <option value="80">80</option><option value="125">125</option>
              </select>

              <label for="metodo">Parâmetro do Ensaio</label>
              <select id="metodo">
                <option value="">Selecione...</option>
                <option value="0.5">0,5 Kgf/cm² × 15 min</option>
                <option value="2">2 Kgf/cm² × 15 min</option>
                <option value="-0.3">-0,3 Bar × 15 min</option>
                <option value="gabarito">Gabarito</option>
                <option value="visual">Visual</option>
                <option value="deflexao_5">Deflexão de (X) 5%</option>
                <option value="deflexao_15">Deflexão de (X) 15%</option>
                <option value="deflexao_20">Deflexão de (X) 20%</option>
                <option value="deflexao_30">Deflexão de (X) 30%</option>
                <option value="queda_500">Altura de Queda 500 mm</option>
                <option value="queda_1000">Altura de Queda 1000 mm</option>
                <option value="queda_2000">Altura de Queda 2000 mm</option>
                <option value="150_15">150º ± 2º × 15 min</option>
                <option value="150_30">150º ± 2º × 30 min</option>
                <option value="deflexao_ponta">Deflexão da ponta ≥10%</option>
                <option value="deflexao_bolsa">Deflexão da bolsa ≥5%</option>
                <option value="diferenca_5">Diferença ≥5%</option>
                <option value="deflexao_angular_dn_le_315">Deflexão Angular dn ≤ 315 mm 2º</option>
                <option value="deflexao_angular_315_630">Deflexão Angular 315 mm &lt; dn ≤ 630 mm 1,5º</option>
                <option value="deflexao_angular_dn_gt_630">Deflexão Angular dn &gt; 630 mm 1º</option>
              </select>

              <label for="resultado">Resultado</label>
              <select id="resultado">
                <option value="">Selecione...</option>
                <option value="aprovado">Aprovado</option>
                <option value="reprovado">Reprovado</option>
              </select>
            </div>

            <div class="inline" style="display:flex;gap:8px;flex-wrap:wrap">
              <button type="button" id="btnAddMetodo" class="btn btn--secondary">
                <svg class="icon" aria-hidden="true"><use href="#i-plus"/></svg>
                Incluir
              </button>
              <button type="button" id="btnLimparMetodo" class="btn btn--secondary">
                <svg class="icon" aria-hidden="true"><use href="#i-reset"/></svg>
                Limpar
              </button>
            </div>
          </fieldset>

          <!-- Resultados dos Ensaios -->
          <fieldset>
            <legend>Resultados dos Ensaios</legend>
            <div class="tabela-wrap">
              <table class="tabela" id="tblResultados">
                <caption class="sr-only">Tabela de resultados dos ensaios</caption>
                <thead>
                  <tr>
                    <th scope="col">Ensaio</th>
                    <th scope="col">Resultado obtido</th>
                    <th scope="col">Requisito normativo</th>
                    <th scope="col">Conformidade</th>
                    <th scope="col" aria-label="Ações"></th>
                  </tr>
                </thead>
                <tbody></tbody>
              </table>
            </div>

            <button type="button" class="btn btn--secondary" id="btnAddResultado" style="margin-top:.6rem">
              <svg class="icon" aria-hidden="true"><use href="#i-plus"/></svg>
              Adicionar resultado
            </button>

            <div id="imagens"></div>
            <button type="button" class="btn btn--secondary" id="btnAddImagem" style="margin-top:.6rem">
              <svg class="icon" aria-hidden="true"><use href="#i-image"/></svg>
              Adicionar imagem
            </button>
            <p class="hint">Cole uma URL de imagem ou selecione um arquivo. Inclua legenda e texto alternativo.</p>

            <div class="container" id="anexos">
              <h6>Adicionar Anexo</h6>
              <p>Preencha as informações abaixo, os campos em negrito são obrigatórios.</p>

              <div class="form-group">
                <label for="descricao"><b>Descrição</b></label>
                <input type="text" id="descricao" placeholder="Descrição" autocomplete="off" />
              </div>

              <div class="form-group">
                <label for="arquivo"><b>Arquivo</b></label>
                <input type="file" id="arquivo" />
              </div>

              <button type="button" id="btnNovoAnexo" class="btn btn--secondary">
                <svg class="icon" aria-hidden="true"><use href="#i-paperclip"/></svg>
                Novo
              </button>
            </div>
          </fieldset>

          <input type="hidden" name="id" />
        </form>
      </section>
    </div>
  </main>

  <footer class="rodape" role="contentinfo">
    <div class="container">
      <small>© <span id="ano"></span> Shiva Conexões — Relatórios digitais.</small>
    </div>
  </footer>
</body>
</html>
