<!doctype html>
<html lang="pt-BR" data-theme="claro">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>RQ-103-01 ‚Äî Registro de Produto e Servi√ßo N√£o Conforme</title>
  <meta name="color-scheme" content="light dark" />
  <meta name="theme-color" content="#0E3554" />

  <!-- CSS externo -->
  <link rel="stylesheet" href="style.css" />

  <!-- jsPDF + AutoTable (carregue APENAS uma vez cada) -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.28/jspdf.plugin.autotable.min.js"></script>

  <!-- Script principal (externo) -->
  <script defer src="script.js"></script>
</head>

<body>
  <noscript>
    <div class="noscript">
      ‚ö†Ô∏è Ative o JavaScript para usar salvar, PDF, adicionar linhas e outros recursos.
    </div>
  </noscript>

  <!-- Skip link -->
  <a class="sr-only sr-only-focusable" href="#conteudo">Pular para o conte√∫do</a>

  <!-- Topbar -->
  <header class="topbar" role="banner">
    <div class="container topbar__inner">
      <div class="brand">
        <img src="shiva.png" alt="Shiva Conex√µes ‚Äî Logo" />
        <div class="brand-text">
          <h1 class="brand-title">RQ-103-01 ‚Äî Registro de Produto e Servi√ßo N√£o Conforme</h1>
        </div>
      </div>

      <nav class="actions" aria-label="A√ß√µes do relat√≥rio">
        <ul class="btn-group-list">
          <li><button id="btnSalvar" class="btn btn--primary" type="button">üíæ Salvar</button></li>
          <li>
            <button id="btnPDF" class="btn btn--secondary" type="button">üìÑ PDF</button>
            <button id="btnImprimir" class="btn btn--secondary" type="button">üñ® Imprimir</button>
          </li>
          <li><button id="btnTemas" class="btn btn--secondary" type="button">üé® Temas</button></li>
        </ul>
      </nav>
    </div>
  </header>

  <!-- Layout -->
  <main class="layout" id="app" role="main">
    <div class="container">

      <!-- Toasts ARIA -->
      <div id="ariaLive" class="sr-only" aria-live="polite" aria-atomic="true"></div>

      <!-- Lista de relat√≥rios -->
      <aside class="lista-relatorios" aria-labelledby="tituloRelatorios">
        <div class="aside-head">
          <h2 id="tituloRelatorios">Relat√≥rios</h2>
          <div class="search-group">
            <label for="filtroLista" class="sr-only">Buscar relat√≥rios</label>
            <input id="filtroLista" type="search" placeholder="Buscar..." autocomplete="off" inputmode="search" />
            <button id="btnBuscarRelatorio" class="btn btn--secondary" type="button"
              aria-label="Buscar relat√≥rio">üîé</button>
          </div>
        </div>
        <ul id="listaRelatorios" aria-live="polite"></ul>
      </aside>

      <!-- Conte√∫do principal -->
      <section class="conteudo" id="conteudo" tabindex="-1">
        <form id="formRelatorio" novalidate>
          <!-- Identifica√ß√£o -->
          <fieldset>
            <legend>Identifica√ß√£o da N√£o Confirmidade</legend>
                <div class="field">
                <label for="quantidadeaverificar">Quantidade a verificar</label>
                <input type="text" id="quantidadeaverificar" name="quantidadeaverificar"
                  value="Acima de 500 pe√ßas verificar o plano de amostragem." readonly aria-readonly="true"
                  inputmode="none" />
              </div>

            <div class="grid-identificacao">
              <div class="field short">
                <label for="quantidade">Quantidade</label>
                <input type="text" id="ordemProducao" name="quantidade" required inputmode="numeric"
                  pattern="^[0-9]{1,}$" autocomplete="off" placeholder="Ex.: 000123" />
              </div>
              
              <div class="field">
                <label for="quandoexecutarinspecao">Quando executar a inspe√ß√£o</label>
                <input type="text" id="quandoexecutarinspecao" name="quandoexecutarinspecao" value="Pe√ßas acabadas"
                  readonly aria-readonly="true" inputmode="none" />
              </div>
              <div class="field">
                <label for="horasInspecao">Horas de inspe√ß√£o</label>
                <input type="text" id="horasInspecao" name="horasInspecao" placeholder="Ex.: 2h 30min" />
              </div>
              <div class="field">
                <label for="dataRelatorio">Data</label>
                <input type="date" id="dataRelatorio" name="dataRelatorio" required />
              </div>
            </div>
          </fieldset>

          <!-- Produtos -->
          <fieldset>
            <legend>Produtos Inspecionados</legend>
            <table id="tabelaProdutos">
              <colgroup>
                <col style="width: 38%" />
                <col style="width: 18%" />
                <col style="width: 18%" />
                <col style="width: 18%" />
                <col style="width: 8%" />
              </colgroup>
              <thead>
                <tr>
                  <th scope="col">Produto</th>
                  <th scope="col">Lote</th>
                  <th scope="col">Data</th>
                  <th scope="col">Quantidade</th>
                  <th scope="col">A√ß√£o</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>
                    <input type="search" name="descricao[]" list="produtosSug" required placeholder="Produto"
                      autocomplete="on" />
                    <datalist id="produtosSug">
                      <option value="Tubo PVC DN75" />
                      <option value="Conector 90¬∫ DN50" />
                      <option value="Anel de Veda√ß√£o EPDM" />
                    </datalist>
                  </td>
                  <td>
                    <input type="text" name="lote[]" placeholder="Ex.: L2025-09" autocapitalize="characters"
                      pattern="^[A-Za-z0-9_-]{1,}$" />
                  </td>
                  <td><input type="date" name="data[]" /></td>
                  <td><input type="number" name="quantidade[]" min="1" step="1" inputmode="numeric" /></td>
                  <td><button type="button" class="remover" aria-label="Remover linha">‚ùå</button></td>
                </tr>
              </tbody>
            </table>
            <div class="table-actions">
              <button type="button" id="addLinha" class="btn">‚ûï Adicionar linha</button>
            </div>
          </fieldset>

          <!-- Ensaios -->
          <fieldset>
            <legend>Ensaios Realizados</legend>
            <table id="tabelaEnsaios">
              <colgroup>
                <col style="width: 30%" />
                <col style="width: 15%" />
                <col style="width: 35%" />
                <col style="width: 12%" />
                <col style="width: 8%" />
              </colgroup>
              <thead>
                <tr>
                  <th scope="col">Ensaio</th>
                  <th scope="col">Amostras</th>
                  <th scope="col">M√©todo</th>
                  <th scope="col">Resultado</th>
                  <th scope="col">A√ß√£o</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>
                    <select name="ensaio[]" required>
                      <option value="">Selecione...</option>
                      <option value="phi">Press√£o hidrost√°tica (PHI)</option>
                      <option value="vacuo">V√°cuo</option>
                      <option value="dimensional">Dimensional</option>
                      <option value="marcacoes">Marca√ß√µes</option>
                      <option value="achatamento">Achatamento</option>
                      <option value="calor">Comportamento ao calor</option>
                      <option value="impacto">Resist√™ncia ao impacto</option>
                      <option value="estanquiedade_anel">Estanquiedade da junta com anel de veda√ß√£o elastom√©rico
                      </option>
                      <option value="mecanica_flexibilidade">Resist√™ncia mec√¢nica ou flexibilidade</option>
                    </select>
                  </td>
                  <td>
                    <select name="amostras[]" required>
                      <option value="">Selecione...</option>
                      <option value="01">01</option>
                      <option value="02">02</option>
                      <option value="03">03</option>
                      <option value="04">04</option>
                      <option value="05">05</option>
                      <option value="06">06</option>
                      <option value="07">07</option>
                      <option value="08">08</option>
                      <option value="09">09</option>
                      <option value="10">10</option>
                      <option value="11">11</option>
                      <option value="12">12</option>
                      <option value="13">13</option>
                      <option value="14">14</option>
                      <option value="15">15</option>
                      <option value="20">20</option>
                      <option value="32">32</option>
                      <option value="50">50</option>
                      <option value="80">80</option>
                      <option value="125">125</option>
                    </select>
                  </td>
                  <td>
                    <select name="metodo[]" required>
                      <option value="0.5_kgf_15min">0,5 Kgf/cm¬≤ √ó 15 min</option>
                      <option value="2_kgf_15min">2 Kgf/cm¬≤ √ó 15 min</option>
                      <option value="-0.3_bar_15min">-0,3 Bar √ó 15 min</option>
                      <option value="gabarito">Gabarito</option>
                      <option value="visual">Visual</option>
                      <option value="deflexao_15">Deflex√£o de (X) 15%</option>
                      <option value="deflexao_30">Deflex√£o de (X) 30%</option>
                      <option value="150c_30min">150¬∫ ¬± 2¬∫ √ó 30 min</option>
                      <option value="Alturadequeda_500">Altura de Queda 500 mm</option>
                      <option value="Alturadequeda_1000">Altura de Queda 1000 mm</option>
                      <option value="Alturadequeda_2000">Altura de Queda 2000 mm</option>
                      <option value="deflexao_ponta_10">Deflex√£o da ponta ‚â•10%</option>
                      <option value="deflexao_bolsa_5">Deflex√£o da bolsa ‚â•5%</option>
                      <option value="diferenca_5">Diferen√ßa ‚â•5%</option>
                      <option value="deflexao_ang_le_315">Deflex√£o Angular dn ‚â§ 315 mm 2¬∫</option>
                      <option value="deflexao_ang_315_630">Deflex√£o Angular 315 mm &lt; dn ‚â§ 630 mm 1,5¬∫</option>
                      <option value="deflexao_ang_gt_630">Deflex√£o Angular dn &gt; 630 mm 1¬∫</option>
                    </select>
                  </td>
                  <td>
                    <select name="resultado[]" required>
                      <option value="">Selecione...</option>
                      <option value="aprovado">Aprovado</option>
                      <option value="reprovado">Reprovado</option>
                    </select>
                  </td>
                  <td><button type="button" class="remover" aria-label="Remover linha">‚ùå</button></td>
                </tr>
              </tbody>
            </table>
            <div class="table-actions">
              <button type="button" id="addEnsaio" class="btn">‚ûï Adicionar linha</button>
            </div>
          </fieldset>

          <!-- OBSERVA√á√ïES + NORMAS -->
          <fieldset>
            <legend>Observa√ß√µes e Normas</legend>
            <div class="field">
              <label for="observacoes">Observa√ß√µes</label>
              <textarea id="observacoes" name="observacoes" rows="3" placeholder="Registre observa√ß√µes relevantes..."
                spellcheck="true"></textarea>
            </div>
            <div class="field">
              <label for="norma">Norma</label>
              <select id="norma" name="norma" required>
                <option value="">Selecione...</option>
                <option value="7362">7362</option>
                <option value="5688">5688</option>
                <option value="7665">7665</option>
                <option value="5647">5647</option>
                <option value="5648">5648</option>
                <option value="NBR 9822">NBR 9822</option>
                <option value="NBR 7231">NBR 7231</option>
                <option value="NBR 6483">NBR 6483</option>
                <option value="NBR 21138">NBR 21138</option>
                <option value="ABNT NBR 5648:2018">ABNT NBR 5648:2018</option>
                <option value="ABNT NBR 8219">ABNT NBR 8219</option>
                <option value="ABNT NBR NM 82">ABNT NBR NM 82</option>
                <option value="ABNT NBR NM 84">ABNT NBR NM 84</option>
                <option value="ABNT NBR 14264">ABNT NBR 14264</option>
                <option value="ABNT NBR 7371">ABNT NBR 7371</option>
                <option value="EN 62321-3-1:2014">EN 62321-3-1:2014</option>
                <option value="ISO 13259:2020 B">ISO 13259:2020 ‚Äî Condi√ß√£o B: com deflex√£o diametral</option>
                <option value="ISO 13259:2020 C">ISO 13259:2020 ‚Äî Condi√ß√£o C: com deflex√£o angular</option>
                <option value="ISO 3260:2010 A">ISO 3260:2010 ‚Äî M√©todo A: √Ågua quente e fria</option>
                <option value="ISO 3260:2010 B">ISO 3260:2010 ‚Äî M√©todo B: √Ågua quente e fria</option>
                <option value="NA">N/A ‚Äî N√£o aplic√°vel</option>
              </select>
            </div>
          </fieldset>

          <!-- FOTOS -->
          <fieldset>
            <legend>Anexar Fotos</legend>

            <div class="upload-area" id="uploadArea" aria-describedby="uploadHint">
              <p>Arraste suas fotos aqui ou</p>
              <input type="file" id="fileInput" class="file-input" accept="image/*" multiple name="fotos[]" />
              <label for="fileInput" class="upload-btn">Selecionar Fotos</label>
              <p class="note" id="uploadHint">Formatos: JPG, PNG. M√°x: 5MB cada.</p>
            </div>

            <div class="image-preview" id="imagePreview" aria-live="polite"></div>
          </fieldset>
        </form>
      </section>
    </div>
  </main>

  <!-- Rodap√© -->
  <footer class="rodape" role="contentinfo">
    <div class="container">
      <small>¬© <span id="ano"></span> Shiva Conex√µes ‚Äî Relat√≥rios digitais.</small>
    </div>
  </footer>

  <!-- Di√°logo Temas -->
  <dialog id="dlgTemas" aria-labelledby="dlgTemasTitle">
    <form method="dialog" id="formTemas">
      <header>
        <strong id="dlgTemasTitle">Escolher tema</strong>
        <button type="button" id="btnFecharDlg" aria-label="Fechar">‚úñ</button>
      </header>

      <div class="temas-options">
        <label><input type="radio" name="tema" value="claro" checked><span class="swatch swatch--claro"></span>
          Claro</label>
        <label><input type="radio" name="tema" value="escuro"><span class="swatch swatch--escuro"></span> Escuro</label>
        <label><input type="radio" name="tema" value="marinho"><span class="swatch swatch--marinho"></span>
          Marinho</label>
        <label><input type="radio" name="tema" value="sepia"><span class="swatch swatch--sepia"></span> S√©pia</label>
      </div>

      <footer>
        <button type="button" class="btn" id="btnCancelarDlg">Cancelar</button>
        <button type="submit" class="btn btn--primary">Aplicar</button>
      </footer>
    </form>
  </dialog>
</body>

</html>